---
import BaseLayout from '../layouts/BaseLayout.astro';
import BandcampEmbed from '../components/BandcampEmbed.astro';
import PhotoGrid from '../components/PhotoGrid.astro';
import MotionGrid from '../components/MotionGrid.astro';
import { getCollection } from 'astro:content';

const featuredRelease = (await getCollection('releases')).find(r => r.data.featured);
---

<BaseLayout title="CLAY - Urban Textures & Industrial Beats">
  <!-- Hero Section -->
  <section class="container mx-auto px-4 py-20 md:py-32">
    <div class="max-w-4xl">
      <h1 class="mb-6">
        Urban textures.<br />
        Industrial beats.<br />
        Concrete frequencies.
      </h1>
      <p class="text-xl text-[--text-secondary] max-w-2xl leading-relaxed">
        DJ, producer, and visual documentarian capturing the geometry of urban spaces
        and translating them into sound.
      </p>
    </div>
  </section>

  <!-- Featured Release -->
  {featuredRelease && (
    <section class="container mx-auto px-4 py-16 border-t border-neutral-800">
      <div class="max-w-5xl mx-auto">
        <h2 class="section-title">Latest Release</h2>
        <div class="grid md:grid-cols-2 gap-12 items-start">
          <div>
            <img
              src={featuredRelease.data.coverImage}
              alt={featuredRelease.data.coverAlt}
              class="w-full aspect-square object-cover card"
            />
          </div>
          <div>
            <time class="text-xs text-[--text-muted] uppercase tracking-wider">
              {featuredRelease.data.date.toLocaleDateString('en-US', { year: 'numeric', month: 'short' })}
            </time>
            <h2 class="text-4xl font-bold mt-2 mb-6">{featuredRelease.data.title}</h2>
            <p class="text-lg text-[--text-secondary] mb-8 leading-relaxed">
              {featuredRelease.data.shortDescription}
            </p>

            <BandcampEmbed albumId={featuredRelease.data.bandcampEmbedId} />

            <div class="flex gap-4 mt-8">
              <a href={featuredRelease.data.bandcampUrl} target="_blank" rel="noopener" class="btn-primary">
                Buy / Support
              </a>
              <a href={`/music/${featuredRelease.id}`} class="btn-secondary">
                More Info
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>
  )}

  <!-- Visuals Preview -->
  <section class="container mx-auto px-4 py-16 border-t border-neutral-800">
    <div class="flex items-end justify-between mb-8">
      <h2 class="section-title mb-0">Visuals</h2>
      <a href="/visuals" class="text-sm uppercase tracking-wider accent-hover">
        View All →
      </a>
    </div>
    <PhotoGrid limit={6} featured={true} />
  </section>

  <!-- Motion Preview -->
  <section class="container mx-auto px-4 py-16 border-t border-neutral-800">
    <div class="flex items-end justify-between mb-8">
      <h2 class="section-title mb-0">Motion</h2>
      <a href="/motion" class="text-sm uppercase tracking-wider accent-hover">
        View All →
      </a>
    </div>
    <MotionGrid limit={3} featured={true} />
  </section>

  <!-- CTA Section -->
  <section class="container mx-auto px-4 py-20 border-t border-neutral-800">
    <div class="max-w-3xl mx-auto text-center">
      <h2 class="text-3xl md:text-5xl font-bold mb-6">
        Stay Connected
      </h2>
      <p class="text-lg text-[--text-secondary] mb-8">
        Get updates on new releases, prints, and tutorials.
      </p>
      <form class="flex flex-col sm:flex-row gap-4 max-w-md mx-auto">
        <input
          type="email"
          placeholder="Your email"
          class="flex-1 px-4 py-3 bg-[--bg-card] border border-neutral-800 focus:border-[--accent] focus:outline-none"
          required
        />
        <button type="submit" class="btn-primary whitespace-nowrap">
          Subscribe
        </button>
      </form>
    </div>
  </section>
</BaseLayout>
