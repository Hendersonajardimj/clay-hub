---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('posts')).sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime()
);

const archetypeLabels = {
  'rack-breakdown': 'Ableton Rack',
  'track-deconstruction': 'Track Breakdown',
  'dj-workflow': 'DJ Workflow',
  'field-recording': 'Field Recording'
};

const difficultyColors = {
  beginner: 'text-green-500',
  intermediate: 'text-yellow-500',
  advanced: 'text-red-500'
};
---

<BaseLayout title="Writing - CLAY" description="Tutorials, breakdowns, and production notes by CLAY">
  <section class="container mx-auto px-4 py-16">
    <h1 class="mb-4">Writing</h1>
    <p class="text-xl text-[--text-secondary] max-w-2xl mb-16">
      Tutorials, production breakdowns, and notes from the studio. Building tools and sharing process.
    </p>

    <div class="grid gap-6 max-w-4xl">
      {posts.map((post) => (
        <article class="card hover:border-[--accent]/50 transition-all">
          <a href={`/writing/${post.id}`} class="block p-6">
            <div class="flex flex-wrap items-center gap-3 mb-3">
              <span class="text-xs uppercase tracking-wider px-3 py-1 bg-[--accent]/20 text-[--accent] border border-[--accent]/30">
                {archetypeLabels[post.data.archetype]}
              </span>
              <span class={`text-xs uppercase tracking-wider ${difficultyColors[post.data.difficulty]}`}>
                {post.data.difficulty}
              </span>
              <time class="text-xs text-[--text-muted] uppercase tracking-wider">
                {post.data.date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })}
              </time>
            </div>

            <h2 class="text-2xl font-bold mb-3 accent-hover">{post.data.title}</h2>
            <p class="text-[--text-secondary] mb-4 leading-relaxed">{post.data.excerpt}</p>

            {post.data.tools && post.data.tools.length > 0 && (
              <div class="flex flex-wrap gap-2">
                {post.data.tools.map((tool) => (
                  <span class="text-xs text-[--text-muted] uppercase tracking-wider">
                    {tool}
                  </span>
                ))}
              </div>
            )}
          </a>
        </article>
      ))}
    </div>

    {posts.length === 0 && (
      <div class="text-center py-20">
        <p class="text-[--text-secondary]">No posts yet. Check back soon for tutorials and breakdowns.</p>
      </div>
    )}
  </section>
</BaseLayout>
